import{u as A,r as g,j as e,aF as T,z as r,Y as N,A as i,C as y,B as b,U as v,X as w,k as n,l as H,aG as R,aH as d,aI as B}from"./index-CI72K9i1.js";import{R as C}from"./refresh-cw-CnbzbTrk.js";function O(){const{employees:t,assignments:l,importData:o,importMetadata:m,dailyTargets:E}=A(),x=g.useRef(null),[h,p]=g.useState(!1),k=()=>{t&&l&&(B(t,l,E),d.success("Data exported successfully!",{description:"Save this file to your Teams folder for other computers to access"}))},I=()=>{x.current?.click()},D=f=>{const u=f.target.files?.[0];if(!u)return;p(!0);const j=new FileReader;j.onload=S=>{const M=S.target?.result,a=R(M);a&&o?(o(a),d.success("Data imported successfully!",{description:`Loaded ${a.employees.length} employees and ${a.assignments.length} assignments`})):d.error("Invalid file format",{description:"Please select a valid AeroStaff sync file (.json)"}),p(!1)},j.readAsText(u),f.target.value=""},s=m?.importedAt?new Date(m.importedAt):null,F=l.length,c=t.length>0;return e.jsxs("div",{className:"p-6 lg:p-8 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl lg:text-3xl font-display font-bold tracking-tight flex items-center gap-3",children:[e.jsx(T,{className:"w-8 h-8 text-primary"}),"Data Sync"]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Export and import all data to sync between computers"})]}),e.jsx("input",{ref:x,type:"file",accept:".json",onChange:D,className:"hidden","data-testid":"input-sync-file"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs(r,{className:"p-6 border-2 hover:border-primary/50 transition-colors","data-testid":"card-export",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-xl bg-primary/10 flex items-center justify-center flex-shrink-0",children:e.jsx(N,{className:"w-7 h-7 text-primary"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-display font-semibold",children:"Export All Data"}),e.jsx("p",{className:"text-muted-foreground text-sm mt-1",children:"Create a backup file with all employees, assignments, and changes"})]})]}),e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(i,{className:"w-4 h-4 text-success"}),e.jsxs("span",{children:[t.length," employees"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(i,{className:"w-4 h-4 text-success"}),e.jsxs("span",{children:[F," shift assignments"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(y,{className:"w-4 h-4"}),e.jsx("span",{children:"File will include today's date in filename"})]})]}),e.jsxs(b,{onClick:k,className:"w-full mt-6 h-12 text-base",disabled:!c,"data-testid":"button-export",children:[e.jsx(N,{className:"w-5 h-5 mr-2"}),"Export to File"]}),!c&&e.jsx("p",{className:"text-sm text-muted-foreground text-center mt-2",children:"No data to export. Import schedule first."})]}),e.jsxs(r,{className:"p-6 border-2 hover:border-primary/50 transition-colors","data-testid":"card-import",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-xl bg-emerald-500/10 flex items-center justify-center flex-shrink-0",children:e.jsx(v,{className:"w-7 h-7 text-emerald-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-display font-semibold",children:"Import Data"}),e.jsx("p",{className:"text-muted-foreground text-sm mt-1",children:"Load data from a sync file to update this computer"})]})]}),e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(w,{className:"w-4 h-4 text-amber-500"}),e.jsx("span",{children:"This will replace all current data"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(y,{className:"w-4 h-4"}),e.jsx("span",{children:"Select a .json file from your Teams folder"})]}),s&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(C,{className:"w-4 h-4"}),e.jsxs("span",{children:["Last import: ",n(s,"MMM d, yyyy HH:mm")]})]})]}),e.jsx(b,{onClick:I,variant:"outline",className:"w-full mt-6 h-12 text-base border-2",disabled:h,"data-testid":"button-import",children:h?e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"w-5 h-5 mr-2 animate-spin"}),"Importing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"w-5 h-5 mr-2"}),"Select File to Import"]})})]})]}),e.jsxs(r,{className:"p-6 bg-muted/30","data-testid":"card-instructions",children:[e.jsx("h3",{className:"font-display font-semibold text-lg mb-4",children:"How to Sync Between Computers"}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary text-primary-foreground flex items-center justify-center font-bold",children:"1"}),e.jsx("h4",{className:"font-semibold",children:"Master Computer"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Make all your changes (shifts, vacations, etc.) on the master laptop"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary text-primary-foreground flex items-center justify-center font-bold",children:"2"}),e.jsx("h4",{className:"font-semibold",children:"Export & Save"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:'Click "Export to File" and save the .json file to your Teams folder'})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary text-primary-foreground flex items-center justify-center font-bold",children:"3"}),e.jsx("h4",{className:"font-semibold",children:"Import on Others"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:'On other computers, click "Import" and select the file from Teams'})]})]})]}),c&&e.jsx(r,{className:H("p-4 border-2",s?"border-success/50 bg-success/5":"border-amber-500/50 bg-amber-500/5"),"data-testid":"card-status",children:e.jsx("div",{className:"flex items-center gap-3",children:s?e.jsxs(e.Fragment,{children:[e.jsx(i,{className:"w-5 h-5 text-success"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Data loaded from sync file"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Imported on ",n(s,"EEEE, MMMM d, yyyy")," at ",n(s,"HH:mm")]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"w-5 h-5 text-amber-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Using local data only"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Export your data to share with other computers"})]})]})})})]})}export{O as SyncPage};
