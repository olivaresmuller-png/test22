import{c as Be,r as u,R as Ge,N as He,j as e,O as We,Q as te,V as J,W as Ye,l as q,u as Ee,D as oe,d as ke,B as D,H as Xe,e as ce,f as de,g as ue,U as Qe,A as ge,X as qe,Y as Ze,I as ne,z as je,Z as Se,_ as Je,$ as es,a0 as ss}from"./index-CI72K9i1.js";import{F as ts,r as ns,u as re,w as rs,l as ls,S as as,U as is}from"./xlsx-DQPdkPbZ.js";import{g as os,u as cs,h as Ce,i as ds,S as W,a as Y,f as X,b as Q,e as S}from"./select-DhOR1Qsq.js";import{B as _,L as K}from"./label-z0vxqCoA.js";import{P as ve,T as us,C as ms}from"./checkbox-POL6qR8n.js";import{P as xs}from"./pen-Dp87l7uz.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],be=Be("award",fs);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],ps=Be("percent",hs);function Z(s,t,{checkForDefaultPrevented:n=!0}={}){return function(o){if(s?.(o),n===!1||!o.defaultPrevented)return t?.(o)}}var gs=Ge[" useInsertionEffect ".trim().toString()]||He;function js({prop:s,defaultProp:t,onChange:n=()=>{},caller:l}){const[o,a,i]=Ss({defaultProp:t,onChange:n}),c=s!==void 0,g=c?s:o;{const p=u.useRef(s!==void 0);u.useEffect(()=>{const d=p.current;d!==c&&console.warn(`${l} is changing from ${d?"controlled":"uncontrolled"} to ${c?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),p.current=c},[c,l])}const w=u.useCallback(p=>{if(c){const d=vs(p)?p(s):p;d!==s&&i.current?.(d)}else a(p)},[c,s,a,i]);return[g,w]}function Ss({defaultProp:s,onChange:t}){const[n,l]=u.useState(s),o=u.useRef(n),a=u.useRef(t);return gs(()=>{a.current=t},[t]),u.useEffect(()=>{o.current!==n&&(a.current?.(n),o.current=n)},[n,o]),[n,l,a]}function vs(s){return typeof s=="function"}var Me=["PageUp","PageDown"],Pe=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Re={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},ee="Slider",[me,bs,Ns]=os(ee),[Te]=We(ee,[Ns]),[ws,le]=Te(ee),De=u.forwardRef((s,t)=>{const{name:n,min:l=0,max:o=100,step:a=1,orientation:i="horizontal",disabled:c=!1,minStepsBetweenThumbs:g=0,defaultValue:w=[l],value:p,onValueChange:d=()=>{},onValueCommit:j=()=>{},inverted:y=!1,form:E,...f}=s,h=u.useRef(new Set),m=u.useRef(0),v=i==="horizontal"?ys:As,[A=[],I]=js({prop:p,defaultProp:w,onChange:N=>{[...h.current][m.current]?.focus(),d(N)}}),U=u.useRef(A);function M(N){const k=Ms(A,N);R(N,k)}function P(N){R(N,m.current)}function $(){const N=U.current[m.current];A[m.current]!==N&&j(A)}function R(N,k,{commit:L}={commit:!1}){const z=Ds(a),O=_s(Math.round((N-l)/a)*a+l,z),F=Ce(O,[l,o]);I((T=[])=>{const C=ks(T,F,k);if(Ts(C,g*a)){m.current=C.indexOf(F);const V=String(C)!==String(T);return V&&L&&j(C),V?C:T}else return T})}return e.jsx(ws,{scope:s.__scopeSlider,name:n,disabled:c,min:l,max:o,valueIndexToChangeRef:m,thumbs:h.current,values:A,orientation:i,form:E,children:e.jsx(me.Provider,{scope:s.__scopeSlider,children:e.jsx(me.Slot,{scope:s.__scopeSlider,children:e.jsx(v,{"aria-disabled":c,"data-disabled":c?"":void 0,...f,ref:t,onPointerDown:Z(f.onPointerDown,()=>{c||(U.current=A)}),min:l,max:o,inverted:y,onSlideStart:c?void 0:M,onSlideMove:c?void 0:P,onSlideEnd:c?void 0:$,onHomeKeyDown:()=>!c&&R(l,0,{commit:!0}),onEndKeyDown:()=>!c&&R(o,A.length-1,{commit:!0}),onStepKeyDown:({event:N,direction:k})=>{if(!c){const O=Me.includes(N.key)||N.shiftKey&&Pe.includes(N.key)?10:1,F=m.current,T=A[F],C=a*O*k;R(T+C,F,{commit:!0})}}})})})})});De.displayName=ee;var[_e,Ie]=Te(ee,{startEdge:"left",endEdge:"right",size:"width",direction:1}),ys=u.forwardRef((s,t)=>{const{min:n,max:l,dir:o,inverted:a,onSlideStart:i,onSlideMove:c,onSlideEnd:g,onStepKeyDown:w,...p}=s,[d,j]=u.useState(null),y=J(t,v=>j(v)),E=u.useRef(void 0),f=cs(o),h=f==="ltr",m=h&&!a||!h&&a;function b(v){const A=E.current||d.getBoundingClientRect(),I=[0,A.width],M=pe(I,m?[n,l]:[l,n]);return E.current=A,M(v-A.left)}return e.jsx(_e,{scope:s.__scopeSlider,startEdge:m?"left":"right",endEdge:m?"right":"left",direction:m?1:-1,size:"width",children:e.jsx(Ue,{dir:f,"data-orientation":"horizontal",...p,ref:y,style:{...p.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:v=>{const A=b(v.clientX);i?.(A)},onSlideMove:v=>{const A=b(v.clientX);c?.(A)},onSlideEnd:()=>{E.current=void 0,g?.()},onStepKeyDown:v=>{const I=Re[m?"from-left":"from-right"].includes(v.key);w?.({event:v,direction:I?-1:1})}})})}),As=u.forwardRef((s,t)=>{const{min:n,max:l,inverted:o,onSlideStart:a,onSlideMove:i,onSlideEnd:c,onStepKeyDown:g,...w}=s,p=u.useRef(null),d=J(t,p),j=u.useRef(void 0),y=!o;function E(f){const h=j.current||p.current.getBoundingClientRect(),m=[0,h.height],v=pe(m,y?[l,n]:[n,l]);return j.current=h,v(f-h.top)}return e.jsx(_e,{scope:s.__scopeSlider,startEdge:y?"bottom":"top",endEdge:y?"top":"bottom",size:"height",direction:y?1:-1,children:e.jsx(Ue,{"data-orientation":"vertical",...w,ref:d,style:{...w.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:f=>{const h=E(f.clientY);a?.(h)},onSlideMove:f=>{const h=E(f.clientY);i?.(h)},onSlideEnd:()=>{j.current=void 0,c?.()},onStepKeyDown:f=>{const m=Re[y?"from-bottom":"from-top"].includes(f.key);g?.({event:f,direction:m?-1:1})}})})}),Ue=u.forwardRef((s,t)=>{const{__scopeSlider:n,onSlideStart:l,onSlideMove:o,onSlideEnd:a,onHomeKeyDown:i,onEndKeyDown:c,onStepKeyDown:g,...w}=s,p=le(ee,n);return e.jsx(te.span,{...w,ref:t,onKeyDown:Z(s.onKeyDown,d=>{d.key==="Home"?(i(d),d.preventDefault()):d.key==="End"?(c(d),d.preventDefault()):Me.concat(Pe).includes(d.key)&&(g(d),d.preventDefault())}),onPointerDown:Z(s.onPointerDown,d=>{const j=d.target;j.setPointerCapture(d.pointerId),d.preventDefault(),p.thumbs.has(j)?j.focus():l(d)}),onPointerMove:Z(s.onPointerMove,d=>{d.target.hasPointerCapture(d.pointerId)&&o(d)}),onPointerUp:Z(s.onPointerUp,d=>{const j=d.target;j.hasPointerCapture(d.pointerId)&&(j.releasePointerCapture(d.pointerId),a(d))})})}),Le="SliderTrack",Fe=u.forwardRef((s,t)=>{const{__scopeSlider:n,...l}=s,o=le(Le,n);return e.jsx(te.span,{"data-disabled":o.disabled?"":void 0,"data-orientation":o.orientation,...l,ref:t})});Fe.displayName=Le;var xe="SliderRange",Ve=u.forwardRef((s,t)=>{const{__scopeSlider:n,...l}=s,o=le(xe,n),a=Ie(xe,n),i=u.useRef(null),c=J(t,i),g=o.values.length,w=o.values.map(j=>$e(j,o.min,o.max)),p=g>1?Math.min(...w):0,d=100-Math.max(...w);return e.jsx(te.span,{"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0,...l,ref:c,style:{...s.style,[a.startEdge]:p+"%",[a.endEdge]:d+"%"}})});Ve.displayName=xe;var fe="SliderThumb",Oe=u.forwardRef((s,t)=>{const n=bs(s.__scopeSlider),[l,o]=u.useState(null),a=J(t,c=>o(c)),i=u.useMemo(()=>l?n().findIndex(c=>c.ref.current===l):-1,[n,l]);return e.jsx(Bs,{...s,ref:a,index:i})}),Bs=u.forwardRef((s,t)=>{const{__scopeSlider:n,index:l,name:o,...a}=s,i=le(fe,n),c=Ie(fe,n),[g,w]=u.useState(null),p=J(t,b=>w(b)),d=g?i.form||!!g.closest("form"):!0,j=Ye(g),y=i.values[l],E=y===void 0?0:$e(y,i.min,i.max),f=Cs(l,i.values.length),h=j?.[c.size],m=h?Ps(h,E,c.direction):0;return u.useEffect(()=>{if(g)return i.thumbs.add(g),()=>{i.thumbs.delete(g)}},[g,i.thumbs]),e.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[c.startEdge]:`calc(${E}% + ${m}px)`},children:[e.jsx(me.ItemSlot,{scope:s.__scopeSlider,children:e.jsx(te.span,{role:"slider","aria-label":s["aria-label"]||f,"aria-valuemin":i.min,"aria-valuenow":y,"aria-valuemax":i.max,"aria-orientation":i.orientation,"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0,tabIndex:i.disabled?void 0:0,...a,ref:p,style:y===void 0?{display:"none"}:s.style,onFocus:Z(s.onFocus,()=>{i.valueIndexToChangeRef.current=l})})}),d&&e.jsx(Ke,{name:o??(i.name?i.name+(i.values.length>1?"[]":""):void 0),form:i.form,value:y},l)]})});Oe.displayName=fe;var Es="RadioBubbleInput",Ke=u.forwardRef(({__scopeSlider:s,value:t,...n},l)=>{const o=u.useRef(null),a=J(o,l),i=ds(t);return u.useEffect(()=>{const c=o.current;if(!c)return;const g=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(g,"value").set;if(i!==t&&p){const d=new Event("input",{bubbles:!0});p.call(c,t),c.dispatchEvent(d)}},[i,t]),e.jsx(te.input,{style:{display:"none"},...n,ref:a,defaultValue:t})});Ke.displayName=Es;function ks(s=[],t,n){const l=[...s];return l[n]=t,l.sort((o,a)=>o-a)}function $e(s,t,n){const a=100/(n-t)*(s-t);return Ce(a,[0,100])}function Cs(s,t){return t>2?`Value ${s+1} of ${t}`:t===2?["Minimum","Maximum"][s]:void 0}function Ms(s,t){if(s.length===1)return 0;const n=s.map(o=>Math.abs(o-t)),l=Math.min(...n);return n.indexOf(l)}function Ps(s,t,n){const l=s/2,a=pe([0,50],[0,l]);return(l-a(t)*n)*n}function Rs(s){return s.slice(0,-1).map((t,n)=>s[n+1]-t)}function Ts(s,t){if(t>0){const n=Rs(s);return Math.min(...n)>=t}return!0}function pe(s,t){return n=>{if(s[0]===s[1]||t[0]===t[1])return t[0];const l=(t[1]-t[0])/(s[1]-s[0]);return t[0]+l*(n-s[0])}}function Ds(s){return(String(s).split(".")[1]||"").length}function _s(s,t){const n=Math.pow(10,t);return Math.round(s*n)/n}var ze=De,Is=Fe,Us=Ve,Ls=Oe;const he=u.forwardRef(({className:s,...t},n)=>e.jsxs(ze,{ref:n,className:q("relative flex w-full touch-none select-none items-center",s),...t,children:[e.jsx(Is,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:e.jsx(Us,{className:"absolute h-full bg-primary"})}),e.jsx(Ls,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));he.displayName=ze.displayName;function Ne(s,t,n){const o=s.Sheets[t][n];if(!o||!o.s)return!1;const a=o.s;if(a.font&&a.font.color){const i=a.font.color;if(i.rgb){const c=i.rgb.toUpperCase();if(c==="FF0000"||c==="C00000"||c==="FF3333"||c.startsWith("FF")&&c.charAt(2)<="3"&&c.charAt(4)<="3")return!0}if(i.theme!==void 0&&i.theme===5)return!0}return!1}function we(s){let t="",n=s;for(;n>=0;)t=String.fromCharCode(n%26+65)+t,n=Math.floor(n/26)-1;return t}const Fs=[{col:5,aircraft:"A220"},{col:6,aircraft:"A320 CF",hasNeo:!0},{col:7,aircraft:"A330 RR"},{col:8,aircraft:"A343"},{col:9,aircraft:"A350"},{col:10,aircraft:"B777"}],Vs=[{col:11,skill:"RR Fan Blade"},{col:12,skill:"A220 RU"},{col:13,skill:"A320 RU"},{col:14,skill:"A320NEO RU"},{col:15,skill:"A330 RU"},{col:16,skill:"A343 RU"},{col:17,skill:"A350 RU"},{col:18,skill:"B777 RU"},{col:19,skill:"A32CFM Boro"},{col:20,skill:"A32PW Boro"},{col:21,skill:"A330RR Boro"},{col:22,skill:"A340 Boro"},{col:23,skill:"A350 Boro"},{col:24,skill:"B777 Boro"},{col:25,skill:"A220 Boro"},{col:26,skill:"Forklift"},{col:27,skill:"Walliclean"},{col:28,skill:"FUEL TANK"},{col:29,skill:"CYCLEAN"},{col:30,skill:"Cobra"}];function Os(s){if(!s)return null;const t=s.toUpperCase().trim();return t==="B1/2"||t==="B1-2"?"B1/2":t.startsWith("B1")?"B1":t.startsWith("B2")?"B2":t==="A"?"A":null}function Ks(s){if(!s)return!1;const t=s.toUpperCase().trim();return t.includes("N")||t.includes("NEO")}function $s(s){if(!s)return{position:"",isMentor:!1};const t=s.toUpperCase().trim(),n=t.includes("GAS");let l="";return t.includes("PM")?l="PM":t.includes("PS")?l="PS":t.includes("SE")&&(l="SE"),{position:l,isMentor:n}}function zs(s){if(!s)return!1;const t=String(s).toUpperCase().trim();return t==="X"||t==="YES"||t==="1"||t==="TRUE"}function Gs(){const[s,t]=u.useState(!1),[n,l]=u.useState([]),[o,a]=u.useState(null),[i,c]=u.useState(!1),g=u.useRef(null),{importData:w,assignments:p,employees:d}=Ee(),j=async f=>{const h=f.target.files?.[0];if(h){c(!0),a(null),l([]);try{const m=await h.arrayBuffer(),b=ns(m,{type:"array",cellStyles:!0}),v=b.SheetNames[0],A=b.Sheets[v],I=re.sheet_to_json(A,{header:1,defval:""}),U=[];for(let M=1;M<I.length;M++){const P=I[M];if(!P||P.length<2)continue;const $=String(P[0]||"").trim(),R=String(P[1]||"").trim().toUpperCase();if(!$||!R||R.length<2)continue;const N=String(P[3]||""),{position:k,isMentor:L}=$s(N),z=[],O=[],F=M+1;for(const{col:C,aircraft:V,hasNeo:se}of Fs){const G=String(P[C]||"").trim(),H=Os(G);if(H){const ae=we(C)+F;Ne(b,v,ae)?O.push(`${V}: ${H}`):(z.push({aircraft:V,license:H}),se&&Ks(G)&&z.push({aircraft:"A320 NEO",license:H}))}}const T=[];L&&T.push("GAS Mentor");for(const{col:C,skill:V}of Vs){const se=P[C];if(zs(se)){const G=we(C)+F;Ne(b,v,G)?O.push(V):T.push(V)}}U.push({name:$,initials:R,position:k,isMentor:L,licenses:z,certifications:T,trainingPlanned:O})}U.length===0?a("No valid employee data found. Make sure column A has names and column B has initials."):l(U)}catch(m){a(`Error reading file: ${m instanceof Error?m.message:"Unknown error"}`)}finally{c(!1),g.current&&(g.current.value="")}}},y=()=>{const f=n.map((h,m)=>{const b=d.find(v=>v.initials===h.initials);return{id:b?b.id:`emp-${h.initials.toLowerCase()}-${m}`,name:h.name,initials:h.initials,department:"S/TMBA",role:h.position==="PM"?"PM":h.position==="PS"?"PS":h.position==="SE"?"SrEng":"Eng",grade:100,skills:h.licenses.map(v=>({aircraftType:v.aircraft,license:v.license})),certifications:h.certifications}});w({employees:f,assignments:p}),t(!1),l([])},E=f=>{switch(f){case"B1":return"bg-blue-500/20 text-blue-400 border-blue-500/30";case"B2":return"bg-green-500/20 text-green-400 border-green-500/30";case"B1/2":return"bg-purple-500/20 text-purple-400 border-purple-500/30";case"A":return"bg-orange-500/20 text-orange-400 border-orange-500/30";default:return""}};return e.jsxs(oe,{open:s,onOpenChange:t,children:[e.jsx(ke,{asChild:!0,children:e.jsxs(D,{variant:"outline",className:"gap-2","data-testid":"button-import-employees",children:[e.jsx(Xe,{className:"w-4 h-4"}),"Import Employees"]})}),e.jsxs(ce,{className:"max-w-5xl max-h-[85vh] overflow-hidden flex flex-col",children:[e.jsx(de,{children:e.jsxs(ue,{className:"flex items-center gap-2",children:[e.jsx(ts,{className:"w-5 h-5"}),"Import Employee Data from Excel"]})}),e.jsxs("div",{className:"space-y-4 flex-1 overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 text-sm space-y-2",children:[e.jsx("p",{className:"font-medium",children:"Expected Excel Format (Columns A-AE):"}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1 text-muted-foreground text-xs",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"A:"})," Name | ",e.jsx("strong",{children:"B:"})," Initials | ",e.jsx("strong",{children:"D:"})," Position (PM/PS/SE/GAS)"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"F-K:"})," Licenses (A220, A320, A330, A343, A350, B777)"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"L:"})," RR Fan Blade | ",e.jsx("strong",{children:"M-S:"})," Run Up capabilities"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"T-Z:"})," Borescope | ",e.jsx("strong",{children:"AA-AE:"})," Forklift, Walliclean, Tank, Cyclean, Cobra"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{ref:g,type:"file",accept:".xlsx,.xls",onChange:j,className:"hidden","data-testid":"input-employee-file"}),e.jsxs(D,{onClick:()=>g.current?.click(),disabled:i,className:"gap-2","data-testid":"button-select-employee-file",children:[e.jsx(Qe,{className:"w-4 h-4"}),i?"Processing...":"Select Excel File"]}),n.length>0&&e.jsxs(_,{variant:"secondary",className:"gap-1",children:[e.jsx(ge,{className:"w-3 h-3"}),n.length," employees found"]})]}),o&&e.jsxs("div",{className:"flex items-center gap-2 text-destructive bg-destructive/10 rounded-lg p-3",children:[e.jsx(qe,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:o})]}),n.length>0&&e.jsx("div",{className:"flex-1 overflow-auto border rounded-lg",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-muted/50 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2 font-medium",children:"Name"}),e.jsx("th",{className:"text-left p-2 font-medium",children:"Code"}),e.jsx("th",{className:"text-left p-2 font-medium",children:"Position"}),e.jsx("th",{className:"text-left p-2 font-medium",children:"Licenses"}),e.jsx("th",{className:"text-left p-2 font-medium",children:"Skills"}),e.jsx("th",{className:"text-left p-2 font-medium text-red-400",children:"Training Planned"})]})}),e.jsx("tbody",{children:n.map((f,h)=>e.jsxs("tr",{className:"border-t hover:bg-muted/30",children:[e.jsx("td",{className:"p-2",children:f.name}),e.jsx("td",{className:"p-2 font-mono font-medium",children:f.initials}),e.jsx("td",{className:"p-2",children:e.jsxs("div",{className:"flex gap-1",children:[f.position&&e.jsx(_,{variant:"outline",children:f.position}),f.isMentor&&e.jsx(_,{variant:"outline",className:"bg-yellow-500/20 text-yellow-500 border-yellow-500/30",children:"GAS"})]})}),e.jsx("td",{className:"p-2",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[f.licenses.map((m,b)=>e.jsxs(_,{variant:"outline",className:`text-xs ${E(m.license)}`,children:[m.aircraft,": ",m.license]},b)),f.licenses.length===0&&e.jsx("span",{className:"text-muted-foreground text-xs",children:"-"})]})}),e.jsx("td",{className:"p-2",children:e.jsxs("div",{className:"flex flex-wrap gap-1 max-w-[200px]",children:[f.certifications.filter(m=>m!=="GAS Mentor").slice(0,4).map((m,b)=>e.jsx(_,{variant:"secondary",className:"text-xs",children:m},b)),f.certifications.filter(m=>m!=="GAS Mentor").length>4&&e.jsxs(_,{variant:"secondary",className:"text-xs",children:["+",f.certifications.filter(m=>m!=="GAS Mentor").length-4]}),f.certifications.filter(m=>m!=="GAS Mentor").length===0&&e.jsx("span",{className:"text-muted-foreground text-xs",children:"-"})]})}),e.jsx("td",{className:"p-2",children:e.jsxs("div",{className:"flex flex-wrap gap-1 max-w-[180px]",children:[f.trainingPlanned.slice(0,3).map((m,b)=>e.jsx(_,{variant:"outline",className:"text-xs bg-red-500/20 text-red-400 border-red-500/30",children:m},b)),f.trainingPlanned.length>3&&e.jsxs(_,{variant:"outline",className:"text-xs bg-red-500/20 text-red-400 border-red-500/30",children:["+",f.trainingPlanned.length-3]}),f.trainingPlanned.length===0&&e.jsx("span",{className:"text-muted-foreground text-xs",children:"-"})]})})]},h))})]})}),n.length>0&&e.jsxs("div",{className:"flex justify-end gap-2 pt-2 border-t",children:[e.jsx(D,{variant:"outline",onClick:()=>{l([]),a(null)},children:"Cancel"}),e.jsxs(D,{onClick:y,className:"gap-2","data-testid":"button-confirm-employee-import",children:[e.jsx(ge,{className:"w-4 h-4"}),"Import ",n.length," Employees"]})]})]})]})]})}const ye=[{col:5,aircraft:"A220"},{col:6,aircraft:"A320 CF",hasNeo:!0},{col:7,aircraft:"A330 RR"},{col:8,aircraft:"A343"},{col:9,aircraft:"A350"},{col:10,aircraft:"B777"}],Ae=[{col:11,skill:"RR Fan Blade"},{col:12,skill:"A220 RU"},{col:13,skill:"A320 RU"},{col:14,skill:"A320NEO RU"},{col:15,skill:"A330 RU"},{col:16,skill:"A343 RU"},{col:17,skill:"A350 RU"},{col:18,skill:"B777 RU"},{col:19,skill:"A32CFM Boro"},{col:20,skill:"A32PW Boro"},{col:21,skill:"A330RR Boro"},{col:22,skill:"A340 Boro"},{col:23,skill:"A350 Boro"},{col:24,skill:"B777 Boro"},{col:25,skill:"A220 Boro"},{col:26,skill:"Forklift"},{col:27,skill:"Walliclean"},{col:28,skill:"FUEL TANK"},{col:29,skill:"CYCLEAN"},{col:30,skill:"Cobra"}];function Hs(s){const t=[];t[0]="Name",t[1]="Initials",t[3]="Position",ye.forEach(a=>t[a.col]=a.aircraft),Ae.forEach(a=>t[a.col]=a.skill);const n=[t];s.forEach(a=>{const i=[];i[0]=a.name,i[1]=a.initials,a.role==="PM"?i[3]="PM":a.role==="PS"?i[3]="PS":a.role==="SrEng"?i[3]="SE":i[3]="Eng",a.certifications.includes("GAS Mentor")&&(i[3]+="/GAS"),ye.forEach(({col:c,aircraft:g,hasNeo:w})=>{const p=a.skills.find(j=>j.aircraftType===g);let d="";if(p&&(d=p.license||"",w)){const j=a.skills.find(y=>y.aircraftType==="A320 NEO");j&&j.license===p.license&&(d+=" NEO")}i[c]=d}),Ae.forEach(({col:c,skill:g})=>{a.certifications.includes(g)&&(i[c]="X")}),n.push(i)});const l=re.book_new(),o=re.aoa_to_sheet(n);o["!cols"]=[{wch:25},{wch:10},{wch:5},{wch:15},{wch:5},{wch:10},{wch:10},{wch:10},{wch:10},{wch:10},{wch:10}],re.book_append_sheet(l,o,"Employees"),rs(l,`Aerostaff_Skills_Export_${new Date().toISOString().split("T")[0]}.xlsx`)}const Ws=["B1","B2","B1/2","A"];function et(){const{employees:s,addEmployee:t,removeEmployee:n,updateEmployee:l}=Ee(),[o,a]=u.useState(""),[i]=ls(o,150),[c,g]=u.useState("all"),[w,p]=u.useState(!1),[d,j]=u.useState(null),[y,E]=u.useState(!1),[f,h]=u.useState([]),[m,b]=u.useState([]),[v,A]=u.useState("Eng"),[I,U]=u.useState(""),[M,P]=u.useState(""),[$,R]=u.useState("B1"),[N,k]=u.useState({initials:"",name:"",department:"S/TMBAA",role:"Eng",grade:100}),L=u.useMemo(()=>s.filter(r=>{const x=r.name.toLowerCase().includes(i.toLowerCase())||r.initials.toLowerCase().includes(i.toLowerCase()),B=c==="all"||r.department===c;return x&&B}),[s,i,c]),z=["PM","PS","SrEng","Eng"],O=u.useMemo(()=>z.map(r=>({role:r,label:r==="PM"?"Production Manager":r==="PS"?"Production Supervisor":r==="SrEng"?"Senior Engineer":"Engineer",employees:L.filter(x=>x.role===r)})).filter(r=>r.employees.length>0),[L]),F=()=>{t({...N,skills:[],certifications:[]}),k({initials:"",name:"",department:"S/TMBAA",role:"Eng",grade:100}),p(!1)},T=u.useCallback((r,x)=>{l(r,{grade:x})},[l]),C=r=>{j(r),h([...r.skills]),b([...r.certifications]),A(r.role),U(r.name),P(""),R("B1"),E(!0)},V=()=>{if(!M)return;f.some(x=>x.aircraftType===M&&x.license===$)||h([...f,{aircraftType:M,license:$}]),P("")},se=r=>{h(f.filter((x,B)=>B!==r))},G=r=>{m.includes(r)?b(m.filter(x=>x!==r)):b([...m,r])},H=()=>{d&&l(d.id,{name:I,role:v,skills:f,certifications:m}),E(!1),j(null)},ae=r=>{switch(r){case"PM":return"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400";case"PS":return"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400";case"SrEng":return"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400";case"Eng":return"bg-slate-100 text-slate-700 dark:bg-slate-800/50 dark:text-slate-400"}};return e.jsxs("div",{className:"p-6 lg:p-8 space-y-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl lg:text-3xl font-display font-bold tracking-tight",children:"Employees"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage team members, skills, and qualifications"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(D,{variant:"outline",className:"gap-2",onClick:()=>Hs(s),"data-testid":"button-export-employees",children:[e.jsx(Ze,{className:"w-4 h-4"}),"Export Skills"]}),e.jsx(Gs,{}),e.jsxs(oe,{open:w,onOpenChange:p,children:[e.jsx(ke,{asChild:!0,children:e.jsxs(D,{"data-testid":"button-add-employee",className:"gap-2",children:[e.jsx(ve,{className:"w-4 h-4"}),"Add Employee"]})}),e.jsxs(ce,{children:[e.jsx(de,{children:e.jsx(ue,{children:"Add New Employee"})}),e.jsxs("div",{className:"space-y-4 pt-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(K,{htmlFor:"initials",children:"Initials"}),e.jsx(ne,{id:"initials","data-testid":"input-initials",placeholder:"e.g., JAWE",value:N.initials,onChange:r=>k(x=>({...x,initials:r.target.value.toUpperCase()}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(K,{htmlFor:"role",children:"Role"}),e.jsxs(W,{value:N.role,onValueChange:r=>k(x=>({...x,role:r})),children:[e.jsx(Y,{"data-testid":"select-role",children:e.jsx(X,{})}),e.jsxs(Q,{children:[e.jsx(S,{value:"PM",children:"Production Manager"}),e.jsx(S,{value:"PS",children:"Production Supervisor"}),e.jsx(S,{value:"SrEng",children:"Senior Engineer"}),e.jsx(S,{value:"Eng",children:"Engineer"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(K,{htmlFor:"name",children:"Full Name"}),e.jsx(ne,{id:"name","data-testid":"input-name",placeholder:"Last name, First name",value:N.name,onChange:r=>k(x=>({...x,name:r.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(K,{htmlFor:"department",children:"Department"}),e.jsxs(W,{value:N.department,onValueChange:r=>k(x=>({...x,department:r})),children:[e.jsx(Y,{"data-testid":"select-department",children:e.jsx(X,{})}),e.jsxs(Q,{children:[e.jsx(S,{value:"S/TMBA",children:"S/TMBA"}),e.jsx(S,{value:"S/TMBAA",children:"S/TMBAA"}),e.jsx(S,{value:"S/TMBAB",children:"S/TMBAB"}),e.jsx(S,{value:"S/TMBAC",children:"S/TMBAC"}),e.jsx(S,{value:"S/TMBAD",children:"S/TMBAD"}),e.jsx(S,{value:"S/TMBB",children:"S/TMBB"}),e.jsx(S,{value:"S/TMBBA",children:"S/TMBBA"}),e.jsx(S,{value:"S/TMBBB",children:"S/TMBBB"}),e.jsx(S,{value:"S/TMBBC",children:"S/TMBBC"}),e.jsx(S,{value:"S/TMBBD",children:"S/TMBBD"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(K,{children:["Grade: ",N.grade,"%"]}),e.jsx(he,{"data-testid":"slider-grade",value:[N.grade],onValueChange:([r])=>k(x=>({...x,grade:r})),min:0,max:100,step:10})]}),e.jsx(D,{onClick:F,className:"w-full","data-testid":"button-confirm-add",children:"Add Employee"})]})]})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(as,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(ne,{"data-testid":"input-search-employees",placeholder:"Search by name or initials...",className:"pl-10",value:o,onChange:r=>a(r.target.value)})]}),e.jsxs(W,{value:c,onValueChange:g,children:[e.jsx(Y,{className:"w-[160px]","data-testid":"select-filter-department",children:e.jsx(X,{placeholder:"Department"})}),e.jsxs(Q,{children:[e.jsx(S,{value:"all",children:"All Departments"}),e.jsx(S,{value:"S/TMBA",children:"S/TMBA"}),e.jsx(S,{value:"S/TMBAA",children:"S/TMBAA"}),e.jsx(S,{value:"S/TMBAB",children:"S/TMBAB"}),e.jsx(S,{value:"S/TMBAC",children:"S/TMBAC"}),e.jsx(S,{value:"S/TMBAD",children:"S/TMBAD"}),e.jsx(S,{value:"S/TMBB",children:"S/TMBB"}),e.jsx(S,{value:"S/TMBBA",children:"S/TMBBA"}),e.jsx(S,{value:"S/TMBBB",children:"S/TMBBB"}),e.jsx(S,{value:"S/TMBBC",children:"S/TMBBC"}),e.jsx(S,{value:"S/TMBBD",children:"S/TMBBD"})]})]})]}),e.jsx("div",{className:"space-y-8",children:O.map(r=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(_,{variant:"outline",className:q("text-sm px-3 py-1",ae(r.role)),children:r.role}),e.jsx("h2",{className:"font-display font-semibold text-lg",children:r.label}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",r.employees.length,")"]})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 xl:grid-cols-3",children:r.employees.map(x=>e.jsxs(je,{className:"p-4 hover:shadow-md transition-shadow","data-testid":`card-employee-${x.id}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-primary/20 to-primary/5 flex items-center justify-center",children:e.jsx("span",{className:"font-mono font-bold text-primary text-[10px]",children:x.initials})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:x.name}),e.jsx("span",{className:"text-xs text-muted-foreground",children:x.department.replace("S/","")})]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(D,{variant:"ghost",size:"icon",className:"text-primary hover:text-primary hover:bg-primary/10",onClick:()=>C(x),"data-testid":`button-edit-${x.id}`,children:e.jsx(xs,{className:"w-4 h-4"})}),e.jsx(D,{variant:"ghost",size:"icon",className:"text-destructive hover:text-destructive hover:bg-destructive/10",onClick:()=>n(x.id),"data-testid":`button-remove-${x.id}`,children:e.jsx(us,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(ps,{className:"w-4 h-4"}),e.jsx("span",{children:"Grade"})]}),e.jsxs("div",{className:"flex items-center gap-3 flex-1 max-w-[180px]",children:[e.jsx(he,{value:[x.grade],onValueChange:([B])=>T(x.id,B),min:0,max:100,step:10,className:"flex-1","data-testid":`slider-grade-${x.id}`}),e.jsxs("span",{className:q("font-mono text-sm font-semibold w-10 text-right",x.grade>=100?"text-success":x.grade===0?"text-destructive":"text-warning"),children:[x.grade,"%"]})]})]}),x.skills.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(be,{className:"w-4 h-4 text-muted-foreground flex-shrink-0"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[x.skills.filter(B=>B.license).slice(0,5).map((B,ie)=>e.jsxs(_,{variant:"secondary",className:q("text-xs",B.license==="B1"&&"bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-300",B.license==="B2"&&"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/50 dark:text-emerald-300",B.license==="B1/2"&&"bg-purple-100 text-purple-700 dark:bg-purple-900/50 dark:text-purple-300"),children:[e.jsx("span",{className:"font-bold",children:B.aircraftType}),e.jsx("span",{className:"mx-0.5 opacity-50",children:"|"}),e.jsx("span",{children:B.license})]},ie)),x.skills.filter(B=>B.license).length>5&&e.jsxs("span",{className:"text-xs text-muted-foreground ml-1",children:["+",x.skills.filter(B=>B.license).length-5]})]})]}),x.certifications.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"w-4 h-4 text-muted-foreground flex-shrink-0"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[x.certifications.slice(0,4).map((B,ie)=>e.jsx(_,{variant:"outline",className:"text-xs bg-amber-50 text-amber-700 border-amber-200 dark:bg-amber-900/20 dark:text-amber-400 dark:border-amber-800",children:B},ie)),x.certifications.length>4&&e.jsxs("span",{className:"text-xs text-muted-foreground ml-1",children:["+",x.certifications.length-4]})]})]})]})]},x.id))})]},r.role))}),L.length===0&&e.jsxs(je,{className:"p-12 text-center",children:[e.jsx(is,{className:"w-12 h-12 mx-auto text-muted-foreground/50 mb-4"}),e.jsx("h3",{className:"font-display font-semibold text-lg mb-2",children:"No employees found"}),e.jsx("p",{className:"text-muted-foreground",children:o?"Try a different search term":"Add your first employee to get started"})]}),e.jsx(oe,{open:y,onOpenChange:E,children:e.jsxs(ce,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(de,{children:e.jsxs(ue,{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-primary/20 to-primary/5 flex items-center justify-center",children:e.jsx("span",{className:"font-mono font-bold text-primary text-xs",children:d?.initials})}),e.jsxs("div",{children:[e.jsxs("span",{children:["Edit Skills - ",d?.name]}),e.jsx("p",{className:"text-sm font-normal text-muted-foreground",children:d?.department})]})]})}),e.jsxs("div",{className:"space-y-6 pt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(K,{className:"text-base font-semibold",children:"Name"}),e.jsx(ne,{value:I,onChange:r=>U(r.target.value),placeholder:"Employee name","data-testid":"input-edit-name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(K,{className:"text-base font-semibold",children:"Position"}),e.jsxs(W,{value:v,onValueChange:r=>A(r),children:[e.jsx(Y,{"data-testid":"select-edit-role",children:e.jsx(X,{})}),e.jsxs(Q,{children:[e.jsx(S,{value:"PM",children:"PM - Production Manager"}),e.jsx(S,{value:"PS",children:"PS - Production Supervisor"}),e.jsx(S,{value:"SrEng",children:"SE - Senior Engineer"}),e.jsx(S,{value:"Eng",children:"Eng - Engineer"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs(K,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(be,{className:"w-4 h-4"}),"Aircraft Licenses"]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(W,{value:M,onValueChange:P,children:[e.jsx(Y,{className:"flex-1","data-testid":"select-aircraft-type",children:e.jsx(X,{placeholder:"Select aircraft type"})}),e.jsx(Q,{children:Je.map(r=>e.jsx(S,{value:r,children:r},r))})]}),e.jsxs(W,{value:$,onValueChange:R,children:[e.jsx(Y,{className:"w-24","data-testid":"select-license-type",children:e.jsx(X,{})}),e.jsx(Q,{children:Ws.map(r=>e.jsx(S,{value:r,children:r},r))})]}),e.jsx(D,{onClick:V,disabled:!M,"data-testid":"button-add-skill",children:e.jsx(ve,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"flex flex-wrap gap-2 min-h-[40px] p-3 bg-muted/30 rounded-lg border border-dashed",children:f.length===0?e.jsx("span",{className:"text-sm text-muted-foreground",children:"No aircraft licenses added"}):f.map((r,x)=>e.jsxs(_,{variant:"secondary",className:q("text-sm gap-1 pr-1",r.license==="B1"&&"bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-300",r.license==="B2"&&"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/50 dark:text-emerald-300",r.license==="B1/2"&&"bg-purple-100 text-purple-700 dark:bg-purple-900/50 dark:text-purple-300"),children:[e.jsx("span",{className:"font-bold",children:r.aircraftType}),e.jsx("span",{className:"mx-0.5 opacity-50",children:"|"}),e.jsx("span",{children:r.license}),e.jsx("button",{onClick:()=>se(x),className:"ml-1 hover:bg-black/10 rounded p-0.5","data-testid":`button-remove-skill-${x}`,children:e.jsx(es,{className:"w-3 h-3"})})]},x))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(K,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(Se,{className:"w-4 h-4"}),"Special Skills & Certifications"]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:ss.map(r=>e.jsxs("div",{className:q("flex items-center gap-2 p-2 rounded-lg border cursor-pointer transition-colors",m.includes(r)?"bg-amber-50 border-amber-300 dark:bg-amber-900/20 dark:border-amber-700":"bg-muted/30 border-transparent hover:border-muted-foreground/20"),onClick:()=>G(r),children:[e.jsx(ms,{checked:m.includes(r),onCheckedChange:()=>G(r),"data-testid":`checkbox-cert-${r.replace(/\s/g,"-")}`}),e.jsx("span",{className:"text-sm",children:r})]},r))})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[e.jsx(D,{variant:"outline",className:"flex-1",onClick:()=>E(!1),children:"Cancel"}),e.jsx(D,{className:"flex-1",onClick:H,"data-testid":"button-save-skills",children:"Save Changes"})]})]})]})})]})}export{et as EmployeesPage};
